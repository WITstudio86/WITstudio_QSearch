# 001-堆,栈
## 栈

- 每个函数是最小编译单位 , 会在占内存中占用一个栈帧
	- 每个栈帧会分配足够的空间存储上下文和存储器
- 当占用的栈内存超出计算机分配的内存之后就会出现栈溢出 , 没计算机终止程序
- **占用内存固定 , 生命周期固定的数据才可以存储到栈内存中**

## 堆内存
- 动态内存 , 动态声明周期需要存储到堆内存中
- 堆上的问题
	- 内存泄露 , 分配后没有清理 , 内存占用越来越多
	- 堆越界: 例如一个进程正在访问列表 , 另一个内存正在删除其中元素 , 可能会访问到野指针
	- 使用已释放内存: 堆上内容已经被清理 , 但是指向这个数据的指针没有被清理

## GC, ARC

- GC 吞吐量大 , 性能更好 , 但是会有不可控出现时间的 STW(stop the word), 会导致程序执行延迟不确定
- ARC 相较于 GC 多了大量额外代码处理计数 , 性能不如 GC
- 但是由于 GC 会导致程序中出现不确定的执行延迟 ,所以从直观感受来说会觉得 GC 的性能不如 ARC


# 思考

1.  如果有一个数据结构需要在多个线程中访问，可以把它放在栈上吗？为什么？
	1. 大概率不可以 , 因为数据的声明周期不受程序员控制 ,可以在一个线程中当前栈帧已经回收, 而另一个进程需要访问
	2. 除非可以确定执行顺序
2. 可以使用指针引用栈上的某个变量吗？如果可以，在什么情况下可以这么做？
	1. 可以 , 但是需要建立在执行顺序或 scope 确定的时候 , 避免被访问变量回收之后还会发生访问